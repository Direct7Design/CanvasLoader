(function(window,document){CanvasLoader=function(options){this.initialize(options);};var shapes=["circle","square","rectangle","roundedRectangle"];var p=CanvasLoader.prototype;p.initialize=function(options){for(var r in options){if(this[r]!=undefined)this[r]=options[r];}try{if(document.getElementById(options["id"])!=undefined){this._container=document.getElementById(options["id"]);}else{this._container=document.body;}}catch(error){this._container=document.body;}this._canvas=document.createElement("canvas");this._context=this._canvas.getContext("2d");this._canvas.id="CanvasLoader";this._container.appendChild(this._canvas);this._canvas.width=this._canvas.height=this._diameter;this._cacheCanvas=document.createElement("canvas");document.body.appendChild(this._cacheCanvas);this._cacheContext=this._cacheCanvas.getContext("2d");this._cacheCanvas.width=this._cacheCanvas.height=this._diameter;this._cacheCanvas.style.display="none";this.setColor(this._color);p._ready=true;this._draw();};p._container=null;p._canvas=null;p._context=null;p._cacheCanvas=null;p._cacheContext=null;p._running=false;p._ready=false;p._timer=null;p._activeId=0;p._diameter=40;p.setDiameter=function(diameter){if(!isNaN(diameter))this._diameter=Math.round(Math.abs(diameter));this._redraw();};p.getDiameter=function(){return this._diameter;};p._colorRGB=null;p._color="#000000";var colorReg=/^\#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/;p.setColor=function(color){this._color=colorReg.test(color)?color:"#000000";this._colorRGB=this._getRGB(this._color);this._redraw();};p.getColor=function(){return this._color;};p._shape=shapes[0];p.setShape=function(shape){var i=0;while(i<shapes.length){if(shape==shapes[i]){this._shape=shape;this._redraw();break;}++i;}};p.getShape=function(){return this._shape;};p._density=40;p.setDensity=function(density){if(!isNaN(density))this._density=Math.round(Math.abs(density));this._redraw();};p.getDensity=function(){return this._density;};p._range=1.3;p.setRange=function(range){if(!isNaN(range))this._range=Math.abs(range);this._redraw();};p.getRange=function(){return this._range;};p._scaling=false;p.setScaling=function(scaling){if(typeof(scaling)=="boolean")this._scaling=scaling;this._redraw();};p.getScaling=function(){return this._scaling;};p._fading=true;p.setFading=function(fading){if(typeof(fading)=="boolean")this._fading=fading;this._redraw();};p.getFading=function(){return this._fading;};p._speed=2;p.setSpeed=function(speed){if(!isNaN(speed)&&Math.abs(speed)>0)this._speed=Math.round(Math.abs(speed));this._reset();};p.getSpeed=function(){return this._speed;};p._fps=24;p.getFPS=function(){return this._fps};p.setFPS=function(fps){if(!isNaN(fps))this._fps=Math.round(Math.abs(fps));this._reset();};p._getRGB=function(color){var hexObject={};color=color.charAt(0)=="#"?color.substring(1,7):color;hexObject.r=parseInt(color.substring(0,2),16);hexObject.g=parseInt(color.substring(2,4),16);hexObject.b=parseInt(color.substring(4,6),16);return hexObject;};p._draw=function(){var i=0;var size=this._diameter*.07;var radians;var w,h,x,y,a,angle,minBitMod;var animBits=Math.round(this._density*this._range);var bitMod;this._cacheContext.clearRect(0,0,this._cacheCanvas.width,this._cacheCanvas.height);this._canvas.width=this._canvas.height=this._cacheCanvas.width=this._cacheCanvas.height=this._diameter;switch(this._shape){case shapes[0]:minBitMod=0.1;while(i<this._density){if(i<=animBits)bitMod=1-((1-minBitMod)/animBits*i);else bitMod=minBitMod;radians=(this._density-i)*((Math.PI*2)/this._density);x=this._canvas.width*.5+Math.cos(radians)*(this._diameter*.45-size)-this._canvas.width*.5;y=this._canvas.height*.5+Math.sin(radians)*(this._diameter*.45-size)-this._canvas.height*.5;this._cacheContext.beginPath();if(this._fading)this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+","+bitMod+")";else this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+",1)";if(this._scaling)this._cacheContext.arc(this._diameter*0.5+x,this._diameter*0.5+y,size*bitMod,0,Math.PI*2,false);else this._cacheContext.arc(this._diameter*0.5+x,this._diameter*0.5+y,size,0,Math.PI*2,false);this._cacheContext.closePath();this._cacheContext.fill();++i;}break;case shapes[1]:size=this._canvas.width*.12;minBitMod=0.1;while(i<this._density){if(i<=animBits)bitMod=1-((1-minBitMod)/animBits*i);else bitMod=minBitMod;angle=360-360/this._density*i;radians=(angle)/180*Math.PI;x=Math.cos(radians)*size*3+this._cacheCanvas.width*0.5;y=Math.sin(radians)*size*3+this._cacheCanvas.height*0.5;this._cacheContext.save();this._cacheContext.translate(x,y);this._cacheContext.rotate(radians);this._cacheContext.translate(-x,-y);this._cacheContext.beginPath();if(this._fading)this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+","+bitMod+")";else this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+",1)";this._cacheContext.fillRect(x,y-size*.5,size,size);this._cacheContext.closePath();this._cacheContext.fill();this._cacheContext.restore();++i;}break;case shapes[2]:w=this._cacheCanvas.width*.24;h=w*.35;minBitMod=0.1;while(i<this._density){if(i<=animBits)bitMod=1-((1-minBitMod)/animBits*i);else bitMod=minBitMod;angle=360-360/this._density*i;radians=(angle)/180*Math.PI;x=Math.cos(radians)*(h+(this._cacheCanvas.height-h)*0.13)+this._cacheCanvas.width*.5
y=Math.sin(radians)*(h+(this._cacheCanvas.height-h)*0.13)+this._cacheCanvas.height*.5;this._cacheContext.save();this._cacheContext.translate(x,y);this._cacheContext.rotate(radians);this._cacheContext.translate(-x,-y);this._cacheContext.beginPath();if(this._fading)this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+","+bitMod+")";else this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+",1)";this._cacheContext.fillRect(x,y-h*.5,w,h);this._cacheContext.closePath();this._cacheContext.fill();this._cacheContext.restore();++i;}break;case shapes[3]:w=this._cacheCanvas.width*.24;h=w*.35;var radius=h*.65;minBitMod=0.1;while(i<this._density){if(i<=animBits)bitMod=1-((1-minBitMod)/animBits*i);else bitMod=minBitMod;angle=360-360/this._density*i;radians=(angle)/180*Math.PI;x=Math.cos(radians)*(h+(this._cacheCanvas.height-h)*0.13)+this._cacheCanvas.width*.5
y=Math.sin(radians)*(h+(this._cacheCanvas.height-h)*0.13)+this._cacheCanvas.height*.5;this._cacheContext.save();this._cacheContext.translate(x,y);this._cacheContext.rotate(radians);this._cacheContext.translate(-x,-y);if(this._fading)this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+","+bitMod+")";else this._cacheContext.fillStyle="rgba("+this._colorRGB.r+","+this._colorRGB.g+","+this._colorRGB.b+",1)";this._cacheContext.beginPath();this._cacheContext.moveTo(x+radius,y-h*.5);this._cacheContext.lineTo(x+w-radius,y-h*.5);this._cacheContext.quadraticCurveTo(x+w,y-h*.5,x+w,y-h*.5+radius);this._cacheContext.lineTo(x+w,y-h*.5+h-radius);this._cacheContext.quadraticCurveTo(x+w,y-h*.5+h,x+w-radius,y-h*.5+h);this._cacheContext.lineTo(x+radius,y-h*.5+h);this._cacheContext.quadraticCurveTo(x,y-h*.5+h,x,y-h*.5+h-radius);this._cacheContext.lineTo(x,y-h*.5+radius);this._cacheContext.quadraticCurveTo(x,y-h*.5,x+radius,y-h*.5);this._cacheContext.closePath();this._cacheContext.fill();this._cacheContext.restore();++i;}break;}this._tick(true);};p._clean=function(){this._context.clearRect(0,0,this._canvas.width,this._canvas.height);};p._redraw=function(){if(this._ready){this._clean();this._draw();}};p._reset=function(){if(this._running){this.stop();this.start();}};p._tick=function(initialize){var rotUnit=this._density>360?this._density/360:360/this._density;rotUnit*=this._speed;if(!initialize)this._activeId+=rotUnit;if(this._activeId>360)this._activeId-=360;this._context.clearRect(0,0,this._diameter,this._diameter);this._context.save();this._context.translate(this._diameter*0.5,this._diameter*0.5);this._context.rotate(Math.PI/180*this._activeId);this._context.translate(-this._diameter*0.5,-this._diameter*0.5);this._context.drawImage(this._cacheCanvas,0,0,this._diameter,this._diameter);this._context.restore();};p.start=function(){if(!this._running){this._running=true;var t=this;this._timer=self.setInterval(function(){t._tick();},Math.round(1000/this._fps));}};p.stop=function(){if(this._running){this._running=false;this._running=false;clearInterval(this._timer);this._timer=null;delete this._timer;}};p.remove=function(){if(this._running)this.stop();this._container.removeChild(this._canvas);};window.CanvasLoader=CanvasLoader;document.CanvasLoader=CanvasLoader;})(window,document);