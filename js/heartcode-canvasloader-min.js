(function(u){var j=function(b){this.initialize(b)},a=j.prototype,o,p=["canvas","vml"],f=["oval","spiral","square","rect","roundRect"],v=/^\#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/,s=navigator.appVersion.indexOf("MSIE")!==-1&&parseFloat(navigator.appVersion.split("MSIE")[1])===8?true:false,w=!!document.createElement("canvas").getContext,l=function(b,i,a){var b=document.createElement(b),c;for(c in a)b[c]=a[c];typeof i!=="undefined"&&i.appendChild(b);return b},n=function(b,i){for(var a in i)b.style[a]=i[a];
return b},q=function(b,i){for(var a in i)b.setAttribute(a,i[a]);return b},r=function(b,i,a,c){b.save();b.translate(i,a);b.rotate(c);b.translate(-i,-a);b.beginPath()};a.initialize=function(b,a){try{this.mother=document.getElementById(b)!==void 0?document.getElementById(b):document.body}catch(f){this.mother=document.body}this.cont=l("div",this.mother,{id:typeof a!=="undefined"?a:"canvasLoader"});if(w)o=p[0],this.canvas=l("canvas",this.cont),this.context=this.canvas.getContext("2d"),this.cacheCanvas=
n(l("canvas",this.cont),{display:"none"}),this.cacheContext=this.cacheCanvas.getContext("2d");else{o=p[1];if(typeof j.vmlSheet==="undefined"){document.getElementsByTagName("head")[0].appendChild(l("style"));j.vmlSheet=document.styleSheets[document.styleSheets.length-1];var c=["group","oval","roundrect","fill"],d;for(d in c)j.vmlSheet.addRule(c[d],"behavior:url(#default#VML); position:absolute;")}this.vml=l("group",this.cont)}this.setColor(this.color);this.ready=true;this.draw();this.show()};a.container=
{};a.canvas={};a.context={};a.cacheCanvas={};a.cacheContext={};a.ready=false;a.timer={};a.activeId=0;a.diameter=40;a.setDiameter=function(b){this.diameter=Math.round(Math.abs(b));this.redraw()};a.getDiameter=function(){return this.diameter};a.colorRGB={};a.color="#000000";a.setColor=function(b){this.color=v.test(b)?b:"#000000";this.colorRGB=this.getRGB(this.color);this.redraw()};a.getColor=function(){return this.color};a.shape=f[0];a.setShape=function(b){for(var a in f)if(b===f[a]){this.shape=b;this.redraw();
break}};a.getShape=function(){return this.shape};a.density=40;a.setDensity=function(b){this.density=Math.round(Math.abs(b));this.redraw()};a.getDensity=function(){return this.density};a.range=1.3;a.setRange=function(b){this.range=Math.abs(b);this.redraw()};a.getRange=function(){return this.range};a.speed=2;a.setSpeed=function(b){this.speed=Math.round(Math.abs(b));this.reset()};a.getSpeed=function(){return this.speed};a.fps=24;a.setFPS=function(b){this.fps=Math.round(Math.abs(b));this.reset()};a.getFPS=
function(){return this.fps};a.getRGB=function(b){b=b.charAt(0)==="#"?b.substring(1,7):b;return{r:parseInt(b.substring(0,2),16),g:parseInt(b.substring(2,4),16),b:parseInt(b.substring(4,6),16)}};a.draw=function(){var b=0,a,g,c,d,e,m,h,j=Math.round(this.density*this.range),k,t=0;if(o===p[0]){this.cacheContext.clearRect(0,0,this.cacheCanvas.width,this.cacheCanvas.height);q(this.canvas,{width:this.diameter,height:this.diameter});for(q(this.cacheCanvas,{width:this.diameter,height:this.diameter});b<this.density;){k=
b<=j?1-1/j*b:k=0;m=360-360/this.density*b;h=m/180*Math.PI;this.cacheContext.fillStyle="rgba("+this.colorRGB.r+","+this.colorRGB.g+","+this.colorRGB.b+","+k.toString()+")";switch(this.shape){case f[0]:case f[1]:a=this.diameter*0.07;d=this.canvas.width*0.5+Math.cos(h)*(this.diameter*0.5-a)-this.canvas.width*0.5;e=this.canvas.height*0.5+Math.sin(h)*(this.diameter*0.5-a)-this.canvas.height*0.5;this.cacheContext.beginPath();this.shape===f[1]?this.cacheContext.arc(this.diameter*0.5+d,this.diameter*0.5+
e,a*k,0,Math.PI*2,false):this.cacheContext.arc(this.diameter*0.5+d,this.diameter*0.5+e,a,0,Math.PI*2,false);break;case f[2]:a=this.diameter*0.12;d=Math.cos(h)*(this.cacheCanvas.width*0.5-a)+this.cacheCanvas.width*0.5;e=Math.sin(h)*(this.cacheCanvas.width*0.5-a)+this.cacheCanvas.height*0.5;r(this.cacheContext,d,e,h);this.cacheContext.fillRect(d,e-a*0.5,a,a);break;case f[3]:case f[4]:g=this.diameter*0.3,c=g*0.27,d=Math.cos(h)*(c+(this.cacheCanvas.height-c)*0.13)+this.cacheCanvas.width*0.5,e=Math.sin(h)*
(c+(this.cacheCanvas.height-c)*0.13)+this.cacheCanvas.height*0.5,r(this.cacheContext,d,e,h),this.shape===f[3]?this.cacheContext.fillRect(d,e-c*0.5,g,c):(a=c*0.7,this.cacheContext.moveTo(d+a,e-c*0.5),this.cacheContext.lineTo(d+g-a,e-c*0.5),this.cacheContext.quadraticCurveTo(d+g,e-c*0.5,d+g,e-c*0.5+a),this.cacheContext.lineTo(d+g,e-c*0.5+c-a),this.cacheContext.quadraticCurveTo(d+g,e-c*0.5+c,d+g-a,e-c*0.5+c),this.cacheContext.lineTo(d+a,e-c*0.5+c),this.cacheContext.quadraticCurveTo(d,e-c*0.5+c,d,e-c*
0.5+c-a),this.cacheContext.lineTo(d,e-c*0.5+a),this.cacheContext.quadraticCurveTo(d,e-c*0.5,d+a,e-c*0.5))}this.cacheContext.closePath();this.cacheContext.fill();this.cacheContext.restore();++b}}else{n(this.cont,{width:this.diameter,height:this.diameter});n(this.vml,{width:this.diameter,height:this.diameter,border:"1px solid #ff0000"});switch(this.shape){case f[0]:case f[1]:h="oval";a=140;break;case f[2]:h="roundrect";a=120;break;case f[3]:case f[4]:h="roundrect",a=300}g=c=a;d=500-c;for(e=-c*0.5;b<
this.density;){k=b<=j?1-1/j*b:k=0;m=270-360/this.density*b;switch(this.shape){case f[1]:g=c=a*k;d=500-a*0.5-a*k*0.5;e=(a-a*k)*0.5;break;case f[0]:case f[2]:s&&(e=0,this.shape===f[2]&&(d=500-c*0.5));break;case f[3]:case f[4]:g=a*0.95,c=g*0.28,s?(d=0,e=500-c*0.5):(d=500-g,e=-c*0.5),t=this.shape===f[4]?0.6:0}m=q(n(l("group",this.vml),{width:1E3,height:1E3,rotation:m}),{coordsize:"1000,1000",coordorigin:"-500,-500"});m=n(l(h,m,{stroked:false,arcSize:t}),{width:g,height:c,top:e,left:d});l("fill",m,{color:this.color,
opacity:k});++b}}this.tick(true)};a.clean=function(){if(o===p[0])this.context.clearRect(0,0,this.canvas.width,this.canvas.height);else if(this.vml.hasChildNodes())for(;this.vml.childNodes.length>=1;)this.vml.removeChild(this.vml.firstChild)};a.redraw=function(){this.ready&&(this.clean(),this.draw())};a.reset=function(){typeof this.timer==="number"&&(this.hide(),this.show())};a.tick=function(a){var f=this.density>360?this.density/360:360/this.density;f*=this.speed;a||(this.activeId+=f);this.activeId>=
360&&(this.activeId-=360);o===p[0]?(this.context.clearRect(0,0,this.diameter,this.diameter),r(this.context,this.diameter*0.5,this.diameter*0.5,Math.PI/180*this.activeId),this.context.drawImage(this.cacheCanvas,0,0,this.diameter,this.diameter),this.context.restore()):this.vml.style.rotation=this.activeId};a.show=function(){if(typeof this.timer!=="number"){var a=this;this.timer=self.setInterval(function(){a.tick()},Math.round(1E3/this.fps));n(this.cont,{display:"block"})}};a.hide=function(){typeof this.timer===
"number"&&(clearInterval(this.timer),delete this.timer,n(this.cont,{display:"none"}))};a.kill=function(){typeof this.timer==="number"&&this.hide();o===p[0]?(this.cont.removeChild(this.canvas),this.cont.removeChild(this.cacheCanvas)):this.cont.removeChild(this.vml);for(var a in this)delete this[a]};u.CanvasLoader=j})(window);